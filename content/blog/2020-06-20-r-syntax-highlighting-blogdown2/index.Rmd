---
title: 'R Snytax Highlighting in blogdown'
author: ~
date: '2020-06-20'
slug: r-syntax-highlight-blogdown-hugo
categories: []
tags: []
description:
output:
  blogdown::html_page:
    toc: true
---

```{r setup, include=FALSE}
library(magrittr)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE, eval = FALSE,
                      results='show', cache=FALSE, autodep=FALSE, error = TRUE)

# knitr::knit_hooks$set(
#   source = highlight::hl_hook_source,
#   document = highlight::hl_hook_css
# )
```

+--------------+--------+---------------+
| highlighter  |  type  |     tokens    |
+==============+========+===============+
| highlight.js | client | strings,      |
|              |        | keywords      |
+--------------+--------+---------------+
| sublime      | n/a    | strings,      |
|              |        | keywords,     |
|              |        | arguments,    |
|              |        | functions,    |
|              |        | operators     |
|              |        |               |
+--------------+--------+---------------+
| Hugo         | server | strings,      |
|              |        | keywords,     |
|              |        | functions,    |
|              |        | operators     |
+--------------+--------+---------------+
| Github       | n/a    | strings,      |
|              |        | argumnets,    |
|              |        | some keywords |
+--------------+--------+---------------+
| RStudio      | n/a    | strings,      |
|              |        | keywords,     |
|              |        | operators,    |
|              |        | parentheses   |
+--------------+--------+---------------+


## Monokai

Sublime

![](sublime-monokai.png)

Hugo

![](hugo-monokai.png)

highlight.js

![](highlightjs-monokai.png)

### Github

Actual Github

![](github.png)

highlight.js

```{r eval=FALSE}
library(tidyverse)

urchins <- read_csv("https://tidymodels.org/start/models/urchins.csv") %>%
  setNames(c("food_regime", "initial_volume", "width")) %>%
  mutate(food_regime = factor(food_regime, levels = c("Init", "Low", "High")))

urchins %>%
  group_by(food_regime) %>%
  summarise(
    across(everything(), mean), n = n()
  )

mean(urchins$width)
ggplot2::cut_interval(urchins$initial_volume)
```

### RStudio

![](rstudio-modern.png)

### Unique highlighting

There is also the highlight [R package](https://github.com/romainfrancois/highlight),
which does semantic highlighting, where words have
unique coloring depending on the context.

```{r echo=FALSE, results='asis'}
library(highlight)
highlight(code, detective = sherlock()) %>% cat()
```

pandoc themes. They are conclusively covered here,
so I won't provide a full array: https://www.garrickadenbuie.com/blog/pandoc-syntax-highlighting-examples/


https://github.com/rstudio/blogdown/issues/360

### Themes and Parsing

Client-side and server-side.

### Commonalities

Save for the unique semantic highlight, there we can find commonalities along
two dimensions: themes and syntax.

Themes are primarily designed around colors, but even then there isn't
a lot of consistency between implementations.

And then there are the parsing rules. These rules decide which tokens gets
highlighted.

The problem with highlight.js is that there aren't enough parsing rules:

```html
<pre class="r">
  <code class="hljs">
    <span class="hljs-keyword">library</span>(tidyverse)

    urchins &lt;- read_csv(<span class="hljs-string">"https://tidymodels.org/start/models/urchins.csv"</span>) %&gt;%
    setNames(c(<span class="hljs-string">"food_regime"</span>, <span class="hljs-string">"initial_volume"</span>, <span class="hljs-string">"width"</span>)) %&gt;%
    mutate(food_regime = factor(food_regime, levels = c(<span class="hljs-string">"Init"</span>, <span class="hljs-string">"Low"</span>, <span class="hljs-string">"High"</span>)))

    urchins %&gt;%
    group_by(food_regime) %&gt;%
    summarise(
      across(everything(), mean), n = n()
    )

    mean(urchins$width)
    ggplot2::cut_interval(urchins$initial_volume)
  </code>
</pre>
```

Only strings and the word `library` are being highlighted.



